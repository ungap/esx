class t{static ATTRIBUTE=1;static COMPONENT=2;static ELEMENT=3;static FRAGMENT=4;static INTERPOLATION=5;static STATIC=6;get properties(){const{attributes:t}=this;if(t.length){const e={};for(const s of t)s.type<2?e[s.name]=s.value:Object.assign(e,s.value);return e}return null}}const e=Object.freeze([]);function s(t,e,...s){const n=(this||JSON).parse(t,...s);return i.call({ids:n,nmsp:e||globalThis},n.pop())}function n(t,...e){const s=[],n=c.call(s,t);return s.push(n),(this||JSON).stringify(s,...e)}function i(s){const{type:n}=s;switch(n){case t.COMPONENT:s.value=this.nmsp[s.name];case t.ELEMENT:case t.FRAGMENT:return s.attributes=(s.attributes||e).map(i,this),s.children=(s.children||e).map(i,this),s.hasOwnProperty("id")&&(s.id=this.ids[s.id]),Object.setPrototypeOf(s,t.prototype);case t.INTERPOLATION:{const{value:e}=s;return{type:t.INTERPOLATION,value:e&&(e.i||i.call(this,e))}}}return s}function c(e){const{type:s}=e;switch(s){case t.COMPONENT:case t.ELEMENT:case t.FRAGMENT:{const n=new t;if(n.type=s,e.hasOwnProperty("id")){const t=this.indexOf(e.id);n.id=t<0?this.push(e.id)-1:t}const{attributes:i,children:a}=e;return i.length&&(n.attributes=i),a.length&&(n.children=a.map(c,this)),e.name&&(n.name=e.name),n}case t.INTERPOLATION:const{value:n}=e;return{...e,value:n instanceof t?c.call(this,n):{i:n}}}return e}export{s as parse,n as stringify};
