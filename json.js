const{assign:e,freeze:t,keys:n}=Object,a=t([]);function r(e,t,n,a,r,s){this.type=e,this.attributes=r,this.children=s,this.name=n,this.value=a,this.dynamic=t}function s(e,t,...n){return i((this||JSON).parse(e,...n),t)}function c(e,...t){return(this||JSON).stringify(u(e),...t)}e(r,{ATTRIBUTE:1,COMPONENT:2,ELEMENT:3,FRAGMENT:4,INTERPOLATION:5,STATIC:6,prototype:{get properties(){const{attributes:t}=this;if(t!==a){const n={};for(const a of t)1===a.type?n[a.name]=a.value:e(n,a.value);return n}return null}}});const i=(e,t={})=>{const{type:n}=e;switch(n){case 1:{const{dynamic:t,name:n,value:a}=e;return new r(1,!!t,n,a)}case 2:case 3:{const{attributes:s,children:c,name:i}=e;return new r(n,!1,i,3===n?i:t[i],s?s.map(o,t):a,c?c.map(o,t):a)}case 4:return new r(n,!1,"#fragment","#fragment",a,e.children.map(o,t));case 5:{const{value:a}=e;return new r(n,!0,"#interpolation",a.i||i(a,t))}case 6:return new r(n,!1,"#static",e.value)}},u=e=>{const{type:t}=e;switch(t){case 1:{const{dynamic:n,name:a,value:r}=e;return n?{type:t,dynamic:1,name:a,value:r}:{type:t,name:a,value:r}}case 2:case 3:{const{attributes:n,children:r,name:s}=e,c={type:t,name:s};return n!==a&&(c.attributes=n.map(u)),r!==a&&(c.children=r.map(u)),c}case 4:return{type:t,children:e.children.map(u)};case 5:{const{value:n}=e;return{type:t,value:n instanceof r?u(n):{i:n}}}case 6:return{type:t,value:e.value}}};function o(e){return i(e,this)}export{i as fromJSON,s as parse,c as stringify,u as toJSON};
