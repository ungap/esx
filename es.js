const{assign:e,freeze:t,keys:n}=Object,s=t([]);function i(e,t,n,s,i,r){this.type=e,this.attributes=i,this.children=r,this.name=n,this.value=s,this.dynamic=t}e(i,{ATTRIBUTE:1,COMPONENT:2,ELEMENT:3,FRAGMENT:4,INTERPOLATION:5,STATIC:6,prototype:{get properties(){const{attributes:t}=this;if(t!==s){const n={};for(const s of t)1===s.type?n[s.name]=s.value:e(n,s.value);return n}return null}}});const r=e=>e.replace(/^[\r\n]\s*|\s*[\r\n]\s*$/g,""),o=([{children:e}],t)=>{e.push(t)},c=new WeakMap,l=(e={})=>{const t=new Set(n(e));return(n,...l)=>(c.get(n)||((e,t,n)=>{const l=({index:e},t)=>{const n=r(f.slice(T,e));if(n){const{length:e}=n;let t=0,s=t;do{if(s=n.indexOf("\0",t),s<0)a(r(n.slice(t)));else{a(r(n.slice(t,s)));const c=new i(5,!0,"#interpolation");if(o(g,c),u.push(c),t=s+1,t===e)break}}while(~s)}T=e+t.length},a=e=>{e&&o(g,new i(6,!1,"#static",e))},h=e=>{g&&o(g,e),g=[e,g||e]},u=[],f=e.join("\0"),p=/(<(\/)?(\S*?)>)|(<(\S+)([^>/]*?)(\/)?>)/g;let g,w,T=0;for(;w=p.exec(f);){const[e,r,o,c,a,f,p,T]=w;switch(e){case"<>":l(w,e),h(new i(4,!1,"#fragment","#fragment",s,[]));break;case"</>":l(w,e),g=g[1];break;default:if(l(w,e),o)g=g[1];else{let e=s;if(p&&p.trim()){e=[];const t=/((\S+)=((('|")([^\5]*)\5)|\x00)|\x00)/g;let n;for(;n=t.exec(p);){const[t,s,r,o,c,l,a]=n;if(l)e.push(new i(1,!1,r,a));else{const t=new i(r?1:5,!0,r||"#interpolation");e.push(t),u.push(t)}}}const r=f||c,o=n.has(r);h(new i(o?2:3,!1,r,o?t[r]:r,e,T?s:[])),T&&(g=g[1])}}}const d=e=>{for(let t=0;t<u.length;t++)u[t].value=e[t];return g};return c.set(e,d),d})(n,e,t))(l)};export{l as ESX,i as Token};
