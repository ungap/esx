const{assign:t,freeze:e,keys:s}=Object,n=e([]),c={},i=void 0;class r{static ATTRIBUTE=1;static COMPONENT=2;static ELEMENT=3;static FRAGMENT=4;static INTERPOLATION=5;static STATIC=6;constructor(t,e,s,n,c,i){this.type=t,this.attributes=e,this.children=s,this.dynamic=n,this.name=c,this.value=i}get properties(){switch(this.type){case 3:case 2:const{attributes:e}=this;if(e!==n){const s={};for(const n of e)1===n.type?s[n.name]=n.value:t(s,n.value);return s}}return null}}const o=(t,e)=>({prev:t,token:e}),a=t=>t.replace(/^[\r\n]\s*|\s*[\r\n]\s*$/g,""),l=new WeakMap,h=(t=c)=>{const e=new Set(s(t));return(s,...c)=>(l.get(s)||((t,e,s)=>{const c=({index:t},e)=>{const s=a(f.slice(v,t));if(s){const{length:t}=s;let e=0,n=e;do{if(n=s.indexOf("\0",e),n<0){const t=a(s.slice(e));t&&h(new r(6,i,i,!1,"#static",t))}else{const c=a(s.slice(e,n));c&&h(new r(6,i,i,!1,"#static",c));const o=new r(5,i,i,!0,"#interpolation",i);if(h(o),u.push(o),e=n+1,e===t)break}}while(~n)}v=t+e.length},h=t=>{g.token.children.push(t)},p=t=>{g?h(t):g=o(i,t),g=o(g,t)},u=[],f=t.join("\0"),w=/(<(\/)?(\S*?)>)|(<(\S+)([^>/]*?)(\/)?>)/g;let g,T,v=0;for(;T=w.exec(f);){const[t,o,a,l,h,f,w,v]=T;switch(t){case"<>":c(T,t),p(new r(4,i,[],!1,"#fragment",i));break;case"</>":c(T,t),g=g.prev;break;default:if(c(T,t),a)g=g.prev;else{let t=n;if(w&&w.trim()){t=[];const e=/((\S+)=((('|")([^\5]*)\5)|\x00)|\x00)/g;let s;for(;s=e.exec(w);){const[e,n,c,o,a,l,h]=s;if(l)t.push(new r(1,i,i,!1,c,h));else{const e=new r(c?1:5,i,i,!0,c||"#interpolation",i);t.push(e),u.push(e)}}}const c=v?n:[],o=f||l,a=s.has(o),h=a?2:3,T=a?e[o]:i;p(new r(h,t,c,!1,o,T)),v&&(g=g.prev)}}}const{token:d}=g,k=t=>{for(let e=0;e<u.length;e++)u[e].value=t[e];return d};return l.set(t,k),k})(s,t,e))(c)};export{h as ESX,r as Token};
