class t{static ATTRIBUTE=1;static COMPONENT=2;static ELEMENT=3;static FRAGMENT=4;static INTERPOLATION=5;static STATIC=6;get properties(){const{attributes:t}=this;if(t.length){const e={};for(const s of t)s.type<2?e[s.name]=s.value:Object.assign(e,s.value);return e}return null}}const e=Object.freeze([]),s=t=>t.replace(/^[\r\n]\s*|\s*[\r\n]\s*$/g,""),n=(t,e)=>({type:t,value:e}),c=(e,s,n)=>({type:t.ATTRIBUTE,dynamic:e,name:s,value:n}),a=(t,s,n,c,a)=>({"\0p":"\x000",type:t,attributes:s===e?"\x001":s,children:n===e?"\x001":n,name:c,value:a}),i=(i,l,o)=>{const u=({index:e},c)=>{const a=s(E.slice(g,e)),{length:i}=a;if(i){let e=0,c=e;do{if(c=a.indexOf("\0",e),c<0)p(s(a.slice(e)));else if(p(s(a.slice(e,c))),T(n(t.INTERPOLATION,"\0a"+ ++A)),e=c+1,e===i)break}while(~c)}g=e+c.length},p=e=>{e&&T(n(t.STATIC,e))},T=t=>{N[0].children.push(t)},f=t=>{N&&T(t),N=[t,N||t]},h=t=>{const e=O.indexOf(t);return"\0"+(e<0?O.push(t)-1:e)},O=[t.prototype,e,{}],E=i.join("\0");let N,g=0,A=0;for(const s of E.matchAll(/(<(\/)?(\S*?)>)|(<(\S+)([^>/]*?)(\/)?>)/g)){const[i,r,p,T,O,E,g,d]=s;switch(i){case"<>":u(s,i),f(a(t.FRAGMENT,e,[]));break;case"</>":u(s,i),N=N[1];break;default:if(u(s,i),p)N=N[1];else{let s=e;if(g&&g.trim()){s=[];for(const[e,a,i,r,l,o,u]of g.matchAll(/((\S+)=((('|")([^\5]*)\5)|\x00)|\x00)/g))if(o)s.push(c(!1,i,u));else{const e="\0a"+ ++A;s.push(i?c(!0,i,e):n(t.INTERPOLATION,e))}}const i=E||T,r=o.has(i);f(a(r?t.COMPONENT:t.ELEMENT,s,d?e:[],i,r?h(l[i]):i)),d&&(N=N[1])}}}N.id="\x002";const d={f:Function(`return ${JSON.stringify(N).replace(/"\\u0000([ap]?)(\d*)"/g,((t,e,s)=>"p"===e?"__proto__":`${e?"arguments":"this"}[${s}]`))}`),c:O};return r.set(i,d),d},r=new WeakMap,l=(t={})=>{const e=new Set(Object.keys(t));return function(s){const{f:n,c:c}=r.get(s)||i(s,t,e);return n.apply(c,arguments)}};export{l as ESX,t as Token};
