const{assign:e,freeze:t,keys:s}=Object,n=t([]),i={},c=(e,t,s,n)=>({type:e,value:n,name:t,dynamic:s});class r{static ATTRIBUTE=1;static COMPONENT=2;static ELEMENT=3;static FRAGMENT=4;static INTERPOLATION=5;static STATIC=6;constructor(e,t,s,n,i){this.type=e,this.attributes=t,this.children=s,this.name=n,this.value=i}get dynamic(){return!1}get properties(){const{attributes:t}=this;if(t!==n){const s={};for(const{type:n,value:i,name:c}of t)1===n?s[c]=i:e(s,i);return s}return null}}const o=(e,t)=>({token:e,prev:t}),a=e=>e.replace(/^[\r\n]\s*|\s*[\r\n]\s*$/g,""),l=new WeakMap,u=(e=i)=>{const t=new Set(s(e));return(s,...i)=>(l.get(s)||((e,t,s)=>{const i=({index:e},t)=>{const s=a(g.slice(v,e));if(s){const{length:e}=s;let t=0,n=t;do{if(n=s.indexOf("\0",t),n<0)u(a(s.slice(t)));else{u(a(s.slice(t,n)));const i=c(5,"#interpolation",!0);if(h(i),f.push(i),t=n+1,t===e)break}}while(~n)}v=e+t.length},u=e=>{e&&h(c(6,"#static",!1,e))},h=e=>{d.token.children.push(e)},p=e=>{d?h(e):d=o(e),d=o(e,d)},f=[],g=e.join("\0"),T=/(<(\/)?(\S*?)>)|(<(\S+)([^>/]*?)(\/)?>)/g;let d,k,v=0;for(;k=T.exec(g);){const[e,o,a,l,u,h,g,T]=k;switch(e){case"<>":i(k,e),p(new r(4,n,[],"#fragment"));break;case"</>":i(k,e),d=d.prev;break;default:if(i(k,e),a)d=d.prev;else{let e=n;if(g&&g.trim()){e=[];const t=/((\S+)=((('|")([^\5]*)\5)|\x00)|\x00)/g;let s;for(;s=t.exec(g);){const[t,n,i,r,o,a,l]=s;if(a)e.push(c(1,i,!1,l));else{const t=c(i?1:5,i||"#interpolation",!0);e.push(t),f.push(t)}}}const i=T?n:[],o=h||l,a=s.has(o),u=a?2:3,k=a?t[o]:o;p(new r(u,e,i,o,k)),T&&(d=d.prev)}}}const{token:m}=d,x=e=>{for(let t=0;t<f.length;t++)f[t].value=e[t];return m};return l.set(e,x),x})(s,e,t))(i)};export{u as ESX,r as Token};
