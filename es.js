class t{static ATTRIBUTE=1;static COMPONENT=2;static ELEMENT=3;static FRAGMENT=4;static INTERPOLATION=5;static STATIC=6;get properties(){const{attributes:t}=this;if(t.length){const e={};for(const s of t)s.type<2?e[s.name]=s.value:Object.assign(e,s.value);return e}return null}}const e=Object.freeze([]),s=t=>t.replace(/^[\r\n]\s*|\s*[\r\n]\s*$/g,""),n=(t,e)=>({type:t,value:e}),c=(e,s,n)=>({type:t.ATTRIBUTE,dynamic:e,name:s,value:n}),i=(t,s,n,c,i)=>({type:t,attributes:s===e?"\x001":s,children:n===e?"\x001":n,name:c,value:i}),a=(a,l,o)=>{const u=({index:e},c)=>{const i=s(E.slice(g,e)),{length:a}=i;if(a){let e=0,c=e;do{if(c=i.indexOf("\0",e),c<0)f(s(i.slice(e)));else if(f(s(i.slice(e,c))),T(n(t.INTERPOLATION,"\0a"+ ++A)),e=c+1,e===a)break}while(~c)}g=e+c.length},f=e=>{e&&T(n(t.STATIC,e))},T=t=>{N[0].children.push(t)},p=t=>{N&&T(t),N=[t,N||t]},O=t=>{const e=h.indexOf(t);return"\0"+(e<0?h.push(t)-1:e)},h=[t.prototype,e,{}],E=a.join("\0");let N,g=0,A=0;for(const s of E.matchAll(/(<(\/)?(\S*?)>)|(<(\S+)([^>/]*?)(\/)?>)/g)){const[a,r,f,T,h,E,g,d]=s;switch(a){case"<>":u(s,a),p(i(t.FRAGMENT,e,[]));break;case"</>":u(s,a),N=N[1];break;default:if(u(s,a),f)N=N[1];else{let s=e;if(g&&g.trim()){s=[];for(const[e,i,a,r,l,o,u]of g.matchAll(/((\S+)=((('|")([^\5]*)\5)|\x00)|\x00)/g))if(o)s.push(c(!1,a,u));else{const e="\0a"+ ++A;s.push(a?c(!0,a,e):n(t.INTERPOLATION,e))}}const a=E||T,r=o.has(a);p(i(r?t.COMPONENT:t.ELEMENT,s,d?e:[],a,r?O(l[a]):a)),d&&(N=N[1])}}}N.id="\x002";const d={f:Function(`return Object.setPrototypeOf(${JSON.stringify(N).replace(/"\\u0000(a?)(\d+)"/g,((t,e,s)=>`${e?"arguments":"this"}[${s}]`))},this[0])`),c:h};return r.set(a,d),d},r=new WeakMap,l=(t={})=>{const e=new Set(Object.keys(t));return function(s){const{f:n,c:c}=r.get(s)||a(s,t,e);return n.apply(c,arguments)}};export{l as ESX,t as Token};
