class t{static ATTRIBUTE=1;static COMPONENT=2;static ELEMENT=3;static FRAGMENT=4;static INTERPOLATION=5;static STATIC=6;get properties(){const{attributes:t}=this;if(t.length){const e={};for(const s of t)s.type<2?e[s.name]=s.value:Object.assign(e,s.value);return e}return null}}const e=Object.freeze([]),s=(t,e)=>t[e],n=t=>t.replace(/^[\r\n]\s*|\s*[\r\n]\s*$/g,""),c=(t,e)=>({type:t,value:e}),i=(e,s,n)=>({type:t.ATTRIBUTE,dynamic:e,name:s,value:n}),a=(t,s,n,c,i)=>({"\0p":"\x000",type:t,attributes:s===e?"\x001":s,children:n===e?"\x001":n,name:c,value:i}),r=(r,o,u)=>{const p=({index:e},s)=>{const i=n(E.slice(g,e)),{length:a}=i;if(a){let e=0,s=e;do{if(s=i.indexOf("\0",e),s<0)f(n(i.slice(e)));else if(f(n(i.slice(e,s))),T(c(t.INTERPOLATION,"\0a"+ ++d)),e=s+1,e===a)break}while(~s)}g=e+s.length},f=e=>{e&&T(c(t.STATIC,e))},T=t=>{N[0].children.push(t)},h=t=>{N&&T(t),N=[t,N||t]},O=[t.prototype,e,{}],E=r.join("\0");let N,g=0,d=0;for(const n of E.matchAll(/(<(\/)?(\S*?)>)|(<(\S+)([^>/]*?)(\/)?>)/g)){const[r,l,f,T,E,g,A,x]=n;switch(r){case"<>":p(n,r),h(a(t.FRAGMENT,e,[]));break;case"</>":p(n,r),N=N[1];break;default:if(p(n,r),f)N=N[1];else{let n=e;if(A&&A.trim()){n=[];for(const[e,s,a,r,l,o,u]of A.matchAll(/((\S+)=((('|")([^\5]*)\5)|\x00)|\x00)/g))if(o)n.push(i(!1,a,u));else{const e="\0a"+ ++d;n.push(a?i(!0,a,e):c(t.INTERPOLATION,e))}}const r=g||T,l=r.split("."),p=u.has(l[0]);let f=r;if(p){const t=l.reduce(s,o),e=O.indexOf(t);f="\0"+(e<0?O.push(t)-1:e)}h(a(p?t.COMPONENT:t.ELEMENT,n,x?e:[],r,f)),x&&(N=N[1])}}}N.id="\x002";const A={f:Function(`return ${JSON.stringify(N).replace(/"\\u0000([ap]?)(\d*)"/g,((t,e,s)=>"p"===e?"__proto__":`${e?"arguments":"this"}[${s}]`))}`),c:O};return l.set(r,A),A},l=new WeakMap,o=(t={})=>{const e=new Set(Object.keys(t));return function(s){const{f:n,c:c}=l.get(s)||r(s,t,e);return n.apply(c,arguments)}};export{o as ESX,t as Token};
