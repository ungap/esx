const{assign:e,freeze:t,keys:s}=Object,n=t([]),i={},c=void 0;class r{static ATTRIBUTE=1;static COMPONENT=2;static ELEMENT=3;static FRAGMENT=4;static INTERPOLATION=5;static STATIC=6;constructor(e,t,s,n,i,c){this.type=e,this.attributes=t,this.children=s,this.dynamic=n,this.name=i,this.value=c}get properties(){switch(this.type){case 3:case 2:const t={},{attributes:s}=this;if(s!==n){for(const n of s)1===n.type?t[n.name]=n.value:e(t,n.value);return t}}return null}}const o=(e,t)=>({prev:e,token:t}),a=e=>e.replace(/^[\r\n]\s*|\s*[\r\n]\s*$/g,""),l=new WeakMap,h=(e=i)=>{const t=new Set(s(e));return(s,...i)=>(l.get(s)||((e,t,s)=>{const i=({index:e},t)=>{const s=a(f.slice(v,e));if(s){const{length:e}=s;let t=0,n=t;do{if(n=s.indexOf("\0",t),n<0){const e=a(s.slice(t));e&&h(new r(6,c,c,!1,"#static",e))}else{const i=a(s.slice(t,n));i&&h(new r(6,c,c,!1,"#static",i));const o=new r(5,c,c,!0,"#interpolation",c);if(h(o),u.push(o),t=n+1,t===e)break}}while(~n)}v=e+t.length},h=e=>{g.token.children.push(e)},p=e=>{g?h(e):g=o(c,e),g=o(g,e)},u=[],f=e.join("\0"),w=/(<(\/)?(\S*?)>)|(<(\S+)([^>/]*?)(\/)?>)/g;let g,T,v=0;for(;T=w.exec(f);){const[e,o,a,l,h,f,w,v]=T;switch(e){case"<>":i(T,e),p(new r(4,c,[],!1,"#fragment",c));break;case"</>":i(T,e),g=g.prev;break;default:if(i(T,e),a)g=g.prev;else{let e=n;if(w&&w.trim()){e=[];const t=/((\S+)=((('|")([^\5]*)\5)|\x00)|\x00)/g;let s;for(;s=t.exec(w);){const[t,n,i,o,a,l,h]=s;if(l)e.push(new r(1,c,c,!1,i,h));else{const t=new r(i?1:5,c,c,!0,i||"#interpolation",c);e.push(t),u.push(t)}}}const i=v?n:[],o=f||l,a=s.has(o),h=a?2:3,T=a?t[o]:c;p(new r(h,e,i,!1,o,T)),v&&(g=g.prev)}}}const{token:d}=g,k=e=>{for(let t=0;t<u.length;t++)u[t].value=e[t];return d};return l.set(e,k),k})(s,e,t))(i)};export{h as ESX,r as Token};
